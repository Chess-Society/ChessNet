import{l as ge,e as fe,g as se,a as _,d as Bt,f as L,s as jt,b as Ut,c as x}from"../chunks/DfPprva0.js";import{I as xe,a as he,i as Vt,e as Ue,f as ct,r as ue,d as vt,b as pe,t as Ht}from"../chunks/SDohX1Oa.js";import{f as U,p as Wt,m as v,l as w,h as qt,b as n,s,g as e,t as z,a as Gt,c as a,i as A,u as d,n as N,r as t,k as ut}from"../chunks/B4zm7d7r.js";import{i as K}from"../chunks/CPpFl6Wl.js";import{c as Jt}from"../chunks/CjI_z-5R.js";import{b as me}from"../chunks/BMuFCVKE.js";import{a as Kt,s as pt}from"../chunks/l-0K12sd.js";import{a as Qt}from"../chunks/D2R-gXPi.js";import{d as Xt}from"../chunks/CaXS0ZTw.js";import{C as Yt}from"../chunks/DZBQXXAS.js";import{M as Zt,E as ea}from"../chunks/CkP46cHH.js";import{n as Ve}from"../chunks/C0n51YRF.js";import{C as mt}from"../chunks/rOygVeRG.js";import{S as ta}from"../chunks/CyaytXpw.js";import{P as aa}from"../chunks/MjU8_qJM.js";import{W as gt}from"../chunks/Bx0mARWW.js";import{C as ra}from"../chunks/BilkHblz.js";import{F as ft}from"../chunks/BEii0wlV.js";import{S as sa}from"../chunks/BJOD2bqC.js";import{T as oa}from"../chunks/BALLaoa6.js";function ia(E,b){const k=ge(b,["children","$$slots","$$events","$$legacy"]);const C=[["path",{d:"m7 7 10 10"}],["path",{d:"M17 7v10H7"}]];xe(E,fe({name:"arrow-down-right"},()=>k,{get iconNode(){return C},children:(D,y)=>{var g=se(),M=U(g);he(M,b,"default",{}),_(D,g)},$$slots:{default:!0}}))}function la(E,b){const k=ge(b,["children","$$slots","$$events","$$legacy"]);const C=[["path",{d:"M7 7h10v10"}],["path",{d:"M7 17 17 7"}]];xe(E,fe({name:"arrow-up-right"},()=>k,{get iconNode(){return C},children:(D,y)=>{var g=se(),M=U(g);he(M,b,"default",{}),_(D,g)},$$slots:{default:!0}}))}function na(E,b){const k=ge(b,["children","$$slots","$$events","$$legacy"]);const C=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2"}],["circle",{cx:"12",cy:"12",r:"2"}],["path",{d:"M6 12h.01M18 12h.01"}]];xe(E,fe({name:"banknote"},()=>k,{get iconNode(){return C},children:(D,y)=>{var g=se(),M=U(g);he(M,b,"default",{}),_(D,g)},$$slots:{default:!0}}))}function da(E,b){const k=ge(b,["children","$$slots","$$events","$$legacy"]);const C=[["path",{d:"M10 18v-7"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z"}],["path",{d:"M14 18v-7"}],["path",{d:"M18 18v-7"}],["path",{d:"M3 22h18"}],["path",{d:"M6 18v-7"}]];xe(E,fe({name:"landmark"},()=>k,{get iconNode(){return C},children:(D,y)=>{var g=se(),M=U(g);he(M,b,"default",{}),_(D,g)},$$slots:{default:!0}}))}var ca=L("<div><!> </div>"),va=L("<option> </option>"),ua=L('<p class="text-red-400 text-xs mt-1 flex items-center gap-1"><svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg> </p>'),pa=L('<p class="text-red-400 text-xs mt-1 flex items-center gap-1"><svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg> </p>'),ma=L('<p class="text-red-400 text-xs mt-1 flex items-center gap-1"><svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg> </p>'),ga=L('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><div class="space-y-2"><label for="payment-student" class="text-sm font-semibold text-slate-400 ml-1">Alumno <span class="text-red-400">*</span></label> <select id="payment-student"><option disabled>Selecciona un alumno</option><!></select> <!></div> <div class="space-y-2"><span class="block text-sm font-semibold text-slate-400 ml-1">Importe y Fecha <span class="text-red-400">*</span></span> <div class="flex gap-2"><div class="relative flex-1"><span class="absolute left-4 top-3 text-slate-500">€</span> <input type="number" aria-label="Importe" placeholder="0.00"/></div> <input type="date" aria-label="Fecha" class="w-40 bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-teal-500 outline-none"/></div> <!></div> <div class="space-y-2"><span class="block text-sm font-semibold text-slate-400 ml-1">Detalles <span class="text-red-400">*</span></span> <div class="flex gap-2"><select aria-label="Método de Pago" class="w-36 bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-teal-500 outline-none"><option>Efectivo</option><option>Transf.</option><option>Bizum</option></select> <input type="text" aria-label="Concepto" placeholder="Concepto (ej: Abril)"/></div> <!></div></div> <div class="mt-8 flex justify-end"><button class="bg-gradient-to-r from-teal-600 to-teal-500 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-teal-500/20 hover:scale-[1.02] active:scale-95 transition-all text-sm">Confirmar Ingreso</button></div>',1),fa=L('<div class="group bg-slate-800/40 hover:bg-slate-800 border border-slate-700/50 hover:border-slate-600 rounded-2xl p-4 flex items-center justify-between transition-all duration-200"><div class="flex items-center gap-4"><div class="w-12 h-12 rounded-full bg-slate-700/50 flex items-center justify-center text-slate-400 group-hover:text-white group-hover:bg-slate-700 transition-colors"><!></div> <div><div class="font-bold text-slate-200 group-hover:text-white"> </div> <div class="text-xs text-slate-500 flex items-center gap-2"><span> </span> <span class="w-1 h-1 rounded-full bg-slate-600"></span> <span class="capitalize"> </span></div></div></div> <div class="flex items-center gap-6"><div class="text-right"><div class="font-bold text-emerald-400 text-lg"> </div> <div class="text-[10px] text-slate-500 uppercase font-bold tracking-wider"> </div></div> <div class="flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity translate-x-4 group-hover:translate-x-0"><button class="p-2 hover:bg-slate-600 rounded-lg text-slate-400 hover:text-white transition-colors" title="Descargar Recibo"><!></button> <button class="p-2 hover:bg-red-500/20 rounded-lg text-slate-400 hover:text-red-400 transition-colors" title="Eliminar"><!></button></div></div></div>'),xa=L('<div><div class="flex items-center gap-4 mb-4"><h3 class="text-lg font-bold text-white capitalize"> </h3> <div class="h-[1px] flex-1 bg-slate-800"></div></div> <div class="space-y-3"></div></div>'),ha=L('<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="flex flex-col md:flex-row md:items-center justify-between gap-6 mb-8"><div><h1 class="text-3xl font-bold text-white flex items-center gap-3"><!> Finanzas</h1> <p class="mt-2 text-slate-400">Panel de control de ingresos y mensualidades.</p></div> <div class="flex gap-3"><div class="relative group"><input type="text" placeholder="Buscar..." class="bg-slate-900 border border-slate-700 rounded-xl pl-10 pr-4 py-2 text-sm text-white focus:outline-none focus:border-teal-500 w-full md:w-64 transition-all"/> <!></div> <button class="bg-teal-600 hover:bg-teal-500 text-white px-4 py-2 rounded-xl font-medium flex items-center gap-2 transition-transform active:scale-95 shadow-lg shadow-teal-900/20"><!> <span class="hidden sm:inline">Nuevo Ingreso</span></button></div></div> <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10"><div class="bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-3xl p-6 relative overflow-hidden group hover:border-slate-600 transition-colors"><div class="absolute right-0 top-0 w-32 h-32 bg-teal-500/10 rounded-full blur-2xl -mr-10 -mt-10 group-hover:bg-teal-500/20 transition-all"></div> <div class="relative z-10"><div class="flex items-center gap-2 mb-2"><div class="p-2 bg-slate-700/50 rounded-lg"><!></div> <span class="text-slate-400 text-sm font-medium">Ingresos Totales</span></div> <div class="text-3xl font-bold text-white tracking-tight"> </div> <div class="text-xs text-slate-500 mt-2">Desde el inicio de los tiempos</div></div></div> <div class="bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-3xl p-6 relative overflow-hidden group hover:border-slate-600 transition-colors"><div class="absolute right-0 bottom-0 w-32 h-32 bg-emerald-500/10 rounded-full blur-2xl -mr-10 -mb-10 group-hover:bg-emerald-500/20 transition-all"></div> <div class="relative z-10"><div class="flex items-center gap-2 mb-2"><div class="p-2 bg-slate-700/50 rounded-lg"><!></div> <span class="text-slate-400 text-sm font-medium"> </span></div> <div class="text-3xl font-bold text-white tracking-tight flex items-end gap-3"> <!></div> <div class="text-xs text-slate-500 mt-2">vs. mes anterior</div></div></div> <div class="bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-3xl p-6 relative overflow-hidden group hover:border-slate-600 transition-colors"><div class="absolute left-0 bottom-0 w-32 h-32 bg-blue-500/10 rounded-full blur-2xl -ml-10 -mb-10 group-hover:bg-blue-500/20 transition-all"></div> <div class="relative z-10"><div class="flex items-center gap-2 mb-2"><div class="p-2 bg-slate-700/50 rounded-lg"><!></div> <span class="text-slate-400 text-sm font-medium">Transacciones</span></div> <div class="text-3xl font-bold text-white tracking-tight"> </div> <div class="text-xs text-slate-500 mt-2">Registrados este mes</div></div></div></div> <!> <div class="space-y-8"><!></div></div> <!>',1);function Fa(E,b){Wt(b,!1);const k=()=>Ut(Kt,"$appStore",C),[C,D]=jt(),y=v(),g=v(),M=v(),S=v(),oe=v(),_e=v(),Q=v(),X=v(),V=v(),be=v(),Y=v(),H=v();let O=v(!1),c=v({id:"",studentId:"",amount:30,concept:"Mensualidad Mes Actual",date:new Date().toISOString().split("T")[0],method:"cash",notes:""}),ie=v(""),i=v({});function xt(){n(i,{});let r=!0;return e(c).studentId||(A(i,e(i).studentId="Selecciona un alumno"),r=!1),(!e(c).amount||e(c).amount<=0)&&(A(i,e(i).amount="El importe debe ser mayor a 0"),r=!1),(!e(c).concept||e(c).concept.trim().length<2)&&(A(i,e(i).concept="El concepto es obligatorio"),r=!1),r}let we=v(!1),He=v(""),We=v(""),qe=v(()=>{}),Ge=v("danger");function $e(r){const o=e(y).students.find(p=>p.id===r);return o?o.name:"Alumno Eliminado"}function ht(r){const[o,p]=r.split("-");return new Date(parseInt(o),parseInt(p)-1,1).toLocaleDateString("es-ES",{month:"long",year:"numeric"})}const _t={cash:na,transfer:da,bizum:sa,other:gt},bt={cash:"Efectivo",transfer:"Transferencia",bizum:"Bizum",other:"Otro"};function wt(){if(!xt()){Ve.error("Por favor, corrige los errores del formulario");return}const r={...e(c),id:crypto.randomUUID()};pt.addPayment(r),Ve.success("Pago registrado correctamente"),n(c,{id:"",studentId:"",amount:30,concept:"Mensualidad",date:new Date().toISOString().split("T")[0],method:"cash",notes:""}),n(i,{}),n(O,!1)}function $t(r){n(He,"¿Eliminar pago?"),n(We,"Esta acción eliminará el registro financiero permanentemente."),n(Ge,"danger"),n(qe,()=>{pt.removePayment(r),Ve.success("Pago eliminado.")}),n(we,!0)}function yt(){n(O,!e(O))}w(()=>k(),()=>{n(y,k())}),w(()=>e(y),()=>{n(g,e(y).payments.sort((r,o)=>new Date(o.date).getTime()-new Date(r.date).getTime()))}),w(()=>(e(g),e(ie)),()=>{n(M,e(g).filter(r=>{const o=$e(r.studentId).toLowerCase(),p=r.concept.toLowerCase(),I=e(ie).toLowerCase();return o.includes(I)||p.includes(I)}))}),w(()=>e(M),()=>{n(S,e(M).reduce((r,o)=>{const p=o.date.substring(0,7);return r[p]||(r[p]=[]),r[p].push(o),r},{}))}),w(()=>e(S),()=>{n(oe,Object.keys(e(S)).sort((r,o)=>o.localeCompare(r)))}),w(()=>e(g),()=>{n(_e,e(g).reduce((r,o)=>r+o.amount,0))}),w(()=>{},()=>{n(Q,new Date().toISOString().substring(0,7))}),w(()=>(e(S),e(Q)),()=>{n(X,(e(S)[e(Q)]||[]).reduce((r,o)=>r+o.amount,0))}),w(()=>{},()=>{n(V,new Date)}),w(()=>e(V),()=>{e(V).setMonth(e(V).getMonth()-1)}),w(()=>e(V),()=>{n(be,e(V).toISOString().substring(0,7))}),w(()=>(e(S),e(be)),()=>{n(Y,(e(S)[e(be)]||[]).reduce((r,o)=>r+o.amount,0))}),w(()=>(e(Y),e(X)),()=>{n(H,e(Y)>0?(e(X)-e(Y))/e(Y)*100:100)}),qt(),Vt();var Je=ha(),ye=U(Je),Me=a(ye),Se=a(Me),Ke=a(Se),Mt=a(Ke);mt(Mt,{class:"w-8 h-8 text-teal-400"}),N(),t(Ke),N(2),t(Se);var Qe=s(Se,2),Ie=a(Qe),ze=a(Ie);ue(ze);var St=s(ze,2);ta(St,{class:"absolute left-3 top-2.5 w-4 h-4 text-slate-500 group-focus-within:text-teal-500"}),t(Ie);var ke=s(Ie,2);ke.__click=()=>n(O,!e(O));var It=a(ke);aa(It,{class:"w-5 h-5"}),N(2),t(ke),t(Qe),t(Me);var Pe=s(Me,2),Ee=a(Pe),Xe=s(a(Ee),2),Ce=a(Xe),Ye=a(Ce),zt=a(Ye);gt(zt,{class:"w-5 h-5 text-slate-300"}),t(Ye),N(2),t(Ce);var Ze=s(Ce,2),kt=a(Ze,!0);t(Ze),N(2),t(Xe),t(Ee);var De=s(Ee,2),et=s(a(De),2),Te=a(et),Ne=a(Te),Pt=a(Ne);ra(Pt,{class:"w-5 h-5 text-emerald-400"}),t(Ne);var tt=s(Ne,2),Et=a(tt);t(tt),t(Te);var at=s(Te,2),rt=a(at),Ct=s(rt);{var Dt=r=>{var o=ca(),p=a(o);{var I=f=>{la(f,{class:"w-3 h-3 mr-1"})},P=f=>{ia(f,{class:"w-3 h-3 mr-1"})};K(p,f=>{e(H)>=0?f(I):f(P,!1)})}var $=s(p);t(o),z(f=>{pe(o,1,`flex items-center text-sm mb-1 px-2 py-0.5 rounded-full ${e(H)>=0?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"}`),x($,` ${f??""}%`)},[()=>(e(H),d(()=>Math.abs(Math.round(e(H)))))]),_(r,o)};K(Ct,r=>{e(H)!==0&&r(Dt)})}t(at),N(2),t(et),t(De);var st=s(De,2),ot=s(a(st),2),Le=a(ot),it=a(Le),Tt=a(it);ft(Tt,{class:"w-5 h-5 text-blue-400"}),t(it),N(2),t(Le);var lt=s(Le,2),Nt=a(lt,!0);t(lt),N(2),t(ot),t(st),t(Pe);var nt=s(Pe,2);Zt(nt,{title:"Registrar Nuevo Pago",size:"lg",get isOpen(){return e(O)},set isOpen(r){n(O,r)},children:(r,o)=>{var p=ga(),I=U(p),P=a(I),$=s(a(P),2);z(()=>{e(c),ut(()=>{e(i),e(y)})});var f=a($);f.value=f.__value="";var le=s(f);Ue(le,1,()=>(e(y),d(()=>e(y).students)),vt,(l,u)=>{var h=va(),J=a(h,!0);t(h);var ve={};z(()=>{x(J,(e(u),d(()=>e(u).name))),ve!==(ve=(e(u),d(()=>e(u).id)))&&(h.value=(h.__value=(e(u),d(()=>e(u).id)))??"")}),_(l,h)}),t($);var Ae=s($,2);{var ne=l=>{var u=ua(),h=s(a(u));t(u),z(()=>x(h,` ${e(i),d(()=>e(i).studentId)??""}`)),_(l,u)};K(Ae,l=>{e(i),d(()=>e(i).studentId)&&l(ne)})}t(P);var T=s(P,2),m=s(a(T),2),R=a(m),F=s(a(R),2);ue(F),t(R);var W=s(R,2);ue(W),t(m);var Oe=s(m,2);{var de=l=>{var u=pa(),h=s(a(u));t(u),z(()=>x(h,` ${e(i),d(()=>e(i).amount)??""}`)),_(l,u)};K(Oe,l=>{e(i),d(()=>e(i).amount)&&l(de)})}t(T);var q=s(T,2),Z=s(a(q),2),B=a(Z);z(()=>{e(c),ut(()=>{})});var j=a(B);j.value=j.__value="cash";var ee=s(j);ee.value=ee.__value="transfer";var te=s(ee);te.value=te.__value="bizum",t(B);var ae=s(B,2);ue(ae),t(Z);var ce=s(Z,2);{var re=l=>{var u=ma(),h=s(a(u));t(u),z(()=>x(h,` ${e(i),d(()=>e(i).concept)??""}`)),_(l,u)};K(ce,l=>{e(i),d(()=>e(i).concept)&&l(re)})}t(q),t(I);var G=s(I,2),Re=a(G);Re.__click=wt,t(G),z(()=>{pe($,1,`w-full bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-teal-500 focus:border-transparent outline-none transition-all ${e(i),d(()=>e(i).studentId?"border-red-500 focus:ring-red-500":"")??""}`),pe(F,1,`w-full bg-slate-900 border border-slate-700 rounded-xl pl-8 pr-4 py-3 text-white focus:ring-2 focus:ring-teal-500 outline-none ${e(i),d(()=>e(i).amount?"border-red-500 focus:ring-red-500":"")??""}`),pe(ae,1,`flex-1 bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-teal-500 outline-none ${e(i),d(()=>e(i).concept?"border-red-500 focus:ring-red-500":"")??""}`)}),ct($,()=>e(c).studentId,l=>A(c,e(c).studentId=l)),me(F,()=>e(c).amount,l=>A(c,e(c).amount=l)),me(W,()=>e(c).date,l=>A(c,e(c).date=l)),ct(B,()=>e(c).method,l=>A(c,e(c).method=l)),me(ae,()=>e(c).concept,l=>A(c,e(c).concept=l)),_(r,p)},$$slots:{default:!0},$$legacy:!0});var dt=s(nt,2),Lt=a(dt);{var At=r=>{ea(r,{get icon(){return mt},title:"Sin movimientos registrados",description:"Aquí aparecerá el historial de pagos. Registra el primer ingreso para empezar a ver datos.",actionLabel:"Nuevo Ingreso",$$events:{action:yt}})},Ot=r=>{var o=se(),p=U(o);Ue(p,1,()=>e(oe),vt,(I,P)=>{var $=xa(),f=a($),le=a(f),Ae=a(le,!0);t(le),N(2),t(f);var ne=s(f,2);Ue(ne,5,()=>(e(S),e(P),d(()=>e(S)[e(P)])),T=>T.id,(T,m)=>{var R=fa(),F=a(R),W=a(F),Oe=a(W);Jt(Oe,()=>_t[e(m).method],(Be,je)=>{je(Be,{class:"w-5 h-5"})}),t(W);var de=s(W,2),q=a(de),Z=a(q,!0);t(q);var B=s(q,2),j=a(B),ee=a(j,!0);t(j);var te=s(j,4),ae=a(te,!0);t(te),t(B),t(de),t(F);var ce=s(F,2),re=a(ce),G=a(re),Re=a(G);t(G);var l=s(G,2),u=a(l,!0);t(l),t(re);var h=s(re,2),J=a(h);J.__click=()=>Xt(e(m),$e(e(m).studentId));var ve=a(J);ft(ve,{class:"w-4 h-4"}),t(J);var Fe=s(J,2);Fe.__click=()=>$t(e(m).id);var Ft=a(Fe);oa(Ft,{class:"w-4 h-4"}),t(Fe),t(h),t(ce),t(R),z((Be,je)=>{x(Z,Be),x(ee,je),x(ae,(e(m),d(()=>e(m).concept))),x(Re,`+${e(m),d(()=>e(m).amount)??""}€`),x(u,(e(m),d(()=>bt[e(m).method])))},[()=>(e(m),d(()=>$e(e(m).studentId))),()=>(e(m),d(()=>new Date(e(m).date).toLocaleDateString()))]),_(T,R)}),t(ne),t($),z(T=>x(Ae,T),[()=>(e(P),d(()=>ht(e(P))))]),Ht(1,$,()=>Qt,()=>({duration:300})),_(I,$)}),_(r,o)};K(Lt,r=>{e(oe),d(()=>e(oe).length===0)?r(At):r(Ot,!1)})}t(dt),t(ye);var Rt=s(ye,2);Yt(Rt,{get title(){return e(He)},get message(){return e(We)},confirmText:"Eliminar",get type(){return e(Ge)},get isOpen(){return e(we)},set isOpen(r){n(we,r)},$$events:{confirm(...r){e(qe)?.apply(this,r)}},$$legacy:!0}),z((r,o,p)=>{x(kt,r),x(Et,`Este Mes (${o??""})`),x(rt,`${p??""} `),x(Nt,(e(S),e(Q),d(()=>e(S)[e(Q)]?.length||0)))},[()=>(e(_e),d(()=>e(_e).toLocaleString("es-ES",{style:"currency",currency:"EUR"}))),()=>d(()=>new Date().toLocaleString("es-ES",{month:"long"})),()=>(e(X),d(()=>e(X).toLocaleString("es-ES",{style:"currency",currency:"EUR"})))]),me(ze,()=>e(ie),r=>n(ie,r)),_(E,Je),Gt(),D()}Bt(["click"]);export{Fa as component};
